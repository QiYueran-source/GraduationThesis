# 毕业论文项目完整方案（简化版）

## 一、🎯 项目概述
### 1.论文标题
**《投资者预期协同的资产定价研究——基于AI-Agent视角》**  

### 2.研究思路概述  
本设计以《投资者预期协同的资产定价研究——基于多特征机器学习视角》为基准研究，参考文中使用深度学习模拟投资者分歧的方式构建“预期分散度”因子IED，构建基于Agent的预期分散度因子AED    

**IED VS AED**  
基准研究中，IED的计算是通过随机赋权初始化神经网络，模拟不同的投资者先验信念的差异，导致预测收益率的偏差。   

使用Agent代替神经网络，由于Agent的能力更强，可以添加设定来区分不同投资者的先验条件，代替随机赋权，具体可以包括  
- 不同风格的投资者(如保守vs激进，通过设定输出方差控制)   
- 不同信息能力的投资者(即信息可达程度不同)   
- 机构与散户(机构具有更强的信息能力，agent分工和更理性的输出)    

由于agent是训练好的模型，无法直接调参，因此通过prompt的形式模拟agent的训练，具体包括：  
- insight机制，agent需要保存思考过程(如insight.txt)，在每次决策前，需要根据上一次决策的insight和实际结果之间的**差异**，动态调整这一次的决策(即自学习)    
- attention机制，模拟深度学习中的attention,为每一个特征设定一个attention(如PE:70)，表示本轮分析中，对该特征的关注程度(不代表权重，代表主观的关注程度)   
- 模拟贝叶斯网络：attention数值可以使用类似贝叶斯网络的形式调整，具体来说，比如计算上期特征-当期收益的多元回归系数，与之前的系数共同输入agent作为“原料”，由agent动态调整本期attention    
- 互学习机制：agent之间可以相互学习，具体来说，每一次交易完成后，agent可以参考其他agent的预测结果、attention乃至insight，但是不同agent的学习能力不同(如机构可以充分学习散户，散户只能部分学习机构)  

基于agent的预测差异，形成AED因子，分析AED因子有效性 

**注意**：LLM是已经训练好的高维深度学习模型，为了充分发挥其非线性能力，不应该为agent设定计算规则（如根据特征的线性回归结果预测收益）。agent的预测行为应当类似"主观多头"   


## 二、基准研究   
### 2.1 特征设计    
基准研究构建了105个公司的多维特征体系，涵盖财务、市场和文本三个维度：  

**财务指标（约35个）：**
- 盈利能力：ROA、ROE、毛利率、净利率、总资产报酬率
- 偿债能力：流动比率、速动比率、资产负债率、利息保障倍数
- 运营效率：总资产周转率、存货周转率、应收账款周转率
- 成长能力：营收增长率、净利润增长率、总资产增长率

**市场指标（约35个）：**
- 估值倍数：PE、PB、PS、EV/EBITDA、市值
波动性：股价波动率、收益波动率、beta系数
流动性：换手率、交易量、交易金额、Amihud流动性
动量效应：短期动量（1-3月）、中期动量（6-12月）
反转效应：短期反转（1月）、长期反转（1年） 

**文本特征（约35个）：**
年报情感分析：正面情感得分、负面情感得分、中性情感得分
文本复杂度：可读性指标、词汇多样性、句子长度
信息含量：管理层讨论与分析(MD&A)长度、风险披露频次
语言风格：乐观程度、谨慎程度、未来导向程度  

进行标准化，填充和异常值剔除操作  

### 2.2 神经网络   
**结构**   
输入层(105节点) → 隐藏层(32-128节点, ReLU激活) → 输出层(1节点)   
- MSE作为损失函数   
- Adam优化器  
- L2正则化和0.2的dropout率  

**随机赋权** 
使用随机赋权初始化神经网络权重，模拟异质信念   

### 2.3 并行与滚动窗口    
**单只证券**  
每次训练一只股票，预测其收益(输入：该股票的105个特征 → 输出：下一个月的预测收益率)   

**滑动窗口**   
每12个月作为一个窗口，每月更新一次  

**并行计算**  
为了提高训练效率，一次并行训练一个batch(32-128只证券)的模型    

## 三、研究设计  
### 3.1 agent设计与训练  
#### 3.1.1 不同的agent决策(初步)   
- 散户投资者
主观成分更多，预测结果的方差更大，信息能力有限
   - 朴素投资者，随机提供预测收益率(或者直接使用历史收益率)  
   - 技术面流派：只获取交易信息  
   - 基本面流派：获取部分基本面信息  
   - 跟风者：只根据机构信息  
   - 情绪面流派：只获取舆论与情绪信息  
按照一定的比例分配   

- 机构投资者  
由不同流派的分析师产生分析报告，交给决策者进行最终决策  
能获取所有信息，理性，要求预测结果尽可能精准   
   - 技术分析 
   - 基本面分析  
   - 机构持仓分析  
   - 市场分析 
   - 宏观分析  
   - 舆论分析  
数量较少   

### 3.1.2 预测的prompt工程(初步)  
为了保证agent充分发挥非线性能力，需要设计prompt工程，包括输入的信息与要求   
初步来看，输入的信息可能包括  
   - 1.风格要求，包括思考的深度、预测的标准差、风险偏好等等  
   - 2.证券的特征数据  
   - 3.对于每一个特征的关注程度，要求agent思考时，按照关注程度大小顺序考虑特征  
应当输出：  
   - 1.预测的收益率  
   - 2.思考过程文本(insight)  

### 3.1.3 注意机制和模拟贝叶斯网络   
**模拟注意机制**  
模拟注意力机制，为每一个特征赋予一个关注度  
agent思考时，应该提高对高关注度特征的使用   

**模拟贝叶斯网络**  
使用模拟贝叶斯网络修正关注度  
具体来说  
   - 在首轮训练时，agent根据对于特征含义的理解，主观赋予特征关注度     
   - 每一轮训练结束后，需要根据当轮特征对于收益率的贡献程度（如多元回归系数），通过贝叶斯方式修正对于特征的关注程度，然后将修正好的关注程度输入到下一次训练的prompt中  

### 3.1.4 互学习机制设计(初步)   
引入互学习机制可能影响AED的计算，具体来说，agent可以在每轮训练时，输入其他agent的“优秀经验”，提高agent之间的预期协同度   

但是，很多经验是私有的，无法共享的，为了贴近真实市场环境，需要设计学习方案，可能包括  
- 机构的学习能力与获取信息的能力强，可以过滤掉非理性的投资者，选择市场上最理性的散户投资者（上一轮预测误差最小）进行学习，获取其注意力参数乃至insight   
- 散户学习者可以学习机构的预测，具体来说，由机构先进行预测，得到结果后，散户可以参考机构的预测结果   

### 3.1.5 并行与滚动  
参考基准研究，按照单只证券+并行训练+滚动窗口的模式进行  

### 3.2 因子评价
参考基准研究对IED因子的评价，采用多空组合检验、Fama-MacBeth回归和CAPM Alpha检验

- 多空组合：按照AED排序构建高协同度vs低协同度组合，检验收益差异
- Fama-MacBeth回归：控制传统因子，检验AED的独立定价能力
- CAPM Alpha：检验AED因子能否产生显著超额收益
- 异质性分析：考察不同市场环境、信息质量等条件下的因子表现

### 3.3 数据与数据来源  
使用CSMAR数据库，时间跨度为2015-2025，包括  
- 交易数据  
- 市场数据  
- 财务数据 
- 宏观数据  
- 舆情数据  
- 年报文本等  

对于文本数据，可能需要使用agent进行编码，方便后续的贝叶斯网络


